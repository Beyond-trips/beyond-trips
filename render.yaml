services:
  # ═══════════════════════════════════════════════════════════════
  # Production Backend Service
  # ═══════════════════════════════════════════════════════════════
  - type: web
    name: beyond-trips-backend-prod
    env: docker
    plan: starter  # Adjust based on your needs (free, starter, standard, pro)
    region: oregon  # Change to your preferred region
    branch: main
    
    # Docker configuration
    dockerfilePath: ./Dockerfile
    dockerContext: .
    
    # Environment variables
    envVars:
      - key: NODE_ENV
        value: production
      
      - key: NODE_OPTIONS
        value: --no-deprecation
      
      - key: PORT
        value: 3000
      
      - key: NEXT_TELEMETRY_DISABLED
        value: 1
      
      # Critical secrets - set these in Render dashboard
      - key: PAYLOAD_SECRET
        sync: false  # Must be set in Render dashboard
      
      - key: MONGODB_URI
        sync: false  # Must be set in Render dashboard
      
      # AWS S3 Configuration - set in Render dashboard
      - key: AWS_ACCESS_KEY_ID
        sync: false
      
      - key: AWS_SECRET_ACCESS_KEY
        sync: false
      
      - key: AWS_REGION
        sync: false
      
      - key: AWS_S3_BUCKET_GENERAL_MEDIA
        sync: false
      
      - key: AWS_S3_BUCKET_PROFILE_PICTURES
        sync: false
      
      - key: AWS_S3_BUCKET_CAMPAIGN_MEDIA
        sync: false
      
      - key: AWS_S3_BUCKET_USER_DOCUMENTS
        sync: false
      
      - key: AWS_S3_BUCKET_ANALYTICS
        sync: false
      
      # Stripe Configuration (if using payments)
      - key: STRIPE_SECRET_KEY
        sync: false
      
      - key: STRIPE_WEBHOOK_SECRET
        sync: false
      
      # Email Configuration (if using email notifications)
      - key: EMAIL_HOST
        sync: false
      
      - key: EMAIL_PORT
        sync: false
      
      - key: EMAIL_USER
        sync: false
      
      - key: EMAIL_PASSWORD
        sync: false
      
      - key: EMAIL_FROM
        sync: false
    
    # Health check configuration
    healthCheckPath: /api/health
    
    # Auto-deploy on git push
    autoDeploy: true
    
    # Enable PR previews (optional)
    pullRequestPreviewsEnabled: false

# ═══════════════════════════════════════════════════════════════
# Optional: Staging Environment
# ═══════════════════════════════════════════════════════════════
# Uncomment to enable staging environment
#
#  - type: web
#    name: beyond-trips-backend-staging
#    env: docker
#    plan: free  # Use free tier for staging
#    region: oregon
#    branch: develop
#    
#    dockerfilePath: ./Dockerfile
#    dockerContext: .
#    
#    envVars:
#      - key: NODE_ENV
#        value: staging
#      
#      - key: NODE_OPTIONS
#        value: --no-deprecation
#      
#      - key: PORT
#        value: 3000
#      
#      # Set staging-specific secrets in Render dashboard
#      - key: PAYLOAD_SECRET
#        sync: false
#      
#      - key: MONGODB_URI
#        sync: false
#    
#    healthCheckPath: /api/health
#    autoDeploy: true

# ═══════════════════════════════════════════════════════════════
# Notes:
# ═══════════════════════════════════════════════════════════════
# 1. All sensitive values (sync: false) must be set in Render dashboard
# 2. Health check endpoint must be implemented at /api/health
# 3. Adjust plan types based on your needs and budget
# 4. Region can be changed to: oregon, frankfurt, singapore, ohio
# 5. PR previews can be enabled for testing before merge

